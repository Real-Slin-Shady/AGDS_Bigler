---
title: "Exercise_3"
author: "Patrick Bigler"
date: "2023-04-24"
output: html_document
---




```{r}
df <- datasets::CO2

help("df")
summary(df)


ggplot(data = df) +
  geom_point(aes(x = conc, y = uptake, , shape = Type)) +
  labs(x = "Concentration", y = "CO2 uptake") +
  geom_smooth(aes(x = conc, y = uptake,color = Treatment, shape = Type), 
              method = "lm", formula = y~log(x))

```


first linear model

```{r}
mod.linear <- lm(uptake~conc, data = df)
summary(mod.linear)

plot(mod.linear)

```

```{r}
curve(log)
curve(x^2, xlim=c(-2,2))

mod_log <- lm(uptake ~ log(conc)+Treatment , data = df)
summary(mod_log)
```

```{r}
mod_cat <- lm(uptake~log(conc), data = df)
```


```{r}
step(object = lm(uptake ~ 1, data = df),
     scope = uptake ~ conc * log(conc) * Type * Treatment,
     direction = "forward")
```


The return of the function gives us a overview about the simple linear regression
models. 

```{r Read_the_file}
# Read the file
database <- read_csv("../data/halfhourly_data.csv")
```


```{r Visualization_of_the_data}
# 


```


```{r Function_for_an_overview}
# Function to determine the best fit for a single regression model
model.fitter <- function(dataframe, target.column.nr){
  # Give all column-names to a vector
  col.names <- c(colnames(dataframe))
  # Create a empty vector. We will fill it with the RR for each model
  my.vec <- c()
  aic.vec <- c()
  # For loop over all columns
  for (i in c(1 : ncol(dataframe))) {
    # If the target and the predictor the same variable RR will be 1.
    # Therefore we use a if statement
    if (i != target.column.nr){
      lm.model <- lm(unlist(dataframe[target.column.nr]) ~ unlist(dataframe[i]))
      RR <- summary(lm.model)$r.squared
      aic.vec <- c(aic.vec, extractAIC(lm.model)[2])
      my.vec <- c(my.vec, RR )
    }
    # If the target and the predictor the same, than we want RR = AIC = 0
    else{
      my.vec <- c(my.vec, NA)
      aic.vec <- c(aic.vec, NA)
    }
  }
  # We create a tibble for a proper overview
  my.tibble <- print(tibble("Target" = rep(col.names[target.column.nr], 
                                     times = ncol(dataframe)),
                      "Predictor" = col.names,
                      "RR"  = my.vec,
                      "AIC" = aic.vec,
                      "Fit" = ifelse(RR >= max(RR, na.rm = TRUE), "BEST FIT", "NO")))
  return(print(my.tibble))
}

model.fitter(database, 16)
I have 
```



```{r}

first.try <- function(dataframe,target){
  df.target <- database|>
  select(col.names[16])
  df.predictor <- database|>
  select(- col.names[16]) 
  col.names <- c(colnames(df.predictor))
  RR.now <- 0
  for (i in c(1 : ncol(df.predictor))) {
    lm.model <- lm(unlist(df.target[1]) ~ unlist(df.predictor[i]))
    RR.new <- summary(lm.model)$r.squared
  if(RR.new > RR.now){
    RR.now <- RR.new
    variable.name <- col.names[i]}
  else{}
  }
  col.names <- col.names[!col.names == variable.name]
  return(print(col.names))
}

test <- first.try(database, 16)
```




